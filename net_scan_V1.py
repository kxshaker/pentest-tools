#!/usr/bin/env python
import scapy.all as scapy


def scan(ip):
    # building the address resolution protocol section within the frame
    arp_request = scapy.ARP()
    arp_request.pdst = ip
        # print(arp_request.summary())
    # building the broadcast frame and setting broadcast address
    broadcast = scapy.Ether()
    broadcast.dst = "FF:FF:FF:FF:FF:FF"
    # constructing the final frame, appending the arp to the ether frame
    broadcast_arp_request = broadcast/arp_request
        # broadcast_arp_request.show()
    answered = scapy.srp(broadcast_arp_request, retry=1, timeout=1)[0]
    # answered.show()
    for host_ans in answered:
        print("------------------")
        print(host_ans[1].psrc)
        print(host_ans[1].hwsrc)
    print("------------------")

scan("192.168.1.1/24")
