#!/usr/env/bin python
import argparse
import scapy.all as scapy

def options():
    parser = argparse.ArgumentParser()
    parser.add_argument("-r", "--range", dest="ip_range", help="Enter an ip range eg:10.0.0.1/24")
    options = parser.parse_args()
    return options

def scan(ip_range):
    broadcast = scapy.Ether(dst="FF:FF:FF:FF:FF:FF")
    arp_request = scapy.ARP(pdst=ip_range)
    broadcast_arp_request = broadcast/arp_request
    answered = scapy.srp(broadcast_arp_request, retry=2, verbose= False or 0, timeout=1)[0]
    #print(answered.show())
    #print(answered.summary())
    print(answered[0][1].hwsrc)
    answered_list = []
    for answer in answered:
        answered_list.append({"ip":answer[1].psrc,"mac":answer[1].hwsrc})
    return answered_list

def print_scan(answered_list):
    print("ip Address\t\tmac Address\n---------------------------------")
    for answer in answered_list:
        print(answer["ip"]+"\t\t"+answer["mac"])


#print_scan(scan(options().ip_range))
scan("192.168.1.1")